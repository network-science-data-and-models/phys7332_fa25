
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Class 17: Dynamics on Networks 2 — Compartmental Models &#8212; PHYS 7332: Network Science Data &amp; Models (Fall 2025)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/class_17/class_17_dynamics2';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Class 16: Dynamics on Networks 1 — Diffusion and Random Walks" href="../class_16/class_16_dynamics1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../README.html">
  
  
  
  
  
  
    <p class="title logo__title">PHYS 7332: Network Science Data & Models (Fall 2025)</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    PHYS 7332: Network Science Data & Models – Fall 2025
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../class_00/class_00_github_computing_setup.html">Class 00: Introduction and Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class_01/class_01_python_refresher.html">Class 01: Python Refresher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class_02/class_02_networkx1.html">Class 02: Introduction to Networkx 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class_03/class_03_networkx2.html">Class 03: Introduction to Networkx 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class_04/class_04_distributions.html">Class 04: Distributions of Network Properties &amp; Centralities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class_05/class_05_scraping1.html">Class 05: Scraping Web Data 1 - BeautifulSoup &amp; HTML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class_06/class_06_data_science_and_sql.html">Class 06: Data Science 1 — Pandas, SQL, Regressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class_07/class_07_creating_a_network_from_sql_tables.html">Class 07: Data Science 2 — SQL for Network Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class_08/class_08_communities1.html">Class 08: Clustering &amp; Community Detection 1 — Traditional</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class_09/class_09_communities2.html">Class 09: Clustering &amp; Community Detection 2 — Contemporary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class_12/class_12_visualization_python.html">Class 12: Visualization 1 — Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class_13/class_13_visualization_python.html">Class 13: Visualization 2 — Advanced Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class_14/class_14_graph_machine_learning_1.html">Class 14: Graph Machine Learning 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class_15/class_15_graph_ml_2.html">Class 15: Graph Machine Learning 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class_16/class_16_dynamics1.html">Class 16: Dynamics 1</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Class 17: Dynamics 2</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/network-science-data-and-models/phys7332_fa25" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/network-science-data-and-models/phys7332_fa25/issues/new?title=Issue%20on%20page%20%2Fnotebooks/class_17/class_17_dynamics2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/class_17/class_17_dynamics2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Class 17: Dynamics on Networks 2 — Compartmental Models</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematical-models-of-epidemic-spreading">Mathematical Models of Epidemic Spreading</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spreading-models-what-are-they-how-do-they-work-why-do-we-use-them">Spreading Models: What are they, how do they work, why do we use them?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-component-of-compartmental-models">Basic Component of Compartmental Models</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#i-individuals-in-are-grouped-by-disease-status">I. Individuals in are grouped by  disease status:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ii-transition-between-compartments">II. Transition between compartments:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#iii-the-dynamical-process-itself">III. The dynamical process itself</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#iv-mixing-method-homogeneous-heterogeneous-etc">IV. Mixing Method: Homogeneous, Heterogeneous, etc.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#si-susceptible-infectious-dynamics">[SI] Susceptible-Infectious Dynamics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sis-susceptible-infectious-susceptible-dynamics">[SIS] Susceptible-Infectious-Susceptible Dynamics</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sis-in-homogeneous-populations">SIS in Homogeneous Populations</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-reproductive-number-r-0">Basic Reproductive Number, <span class="math notranslate nohighlight">\(R_0\)</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir-susceptible-infectious-recovered-dynamics">[SIR] Susceptible-Infectious-Recovered Dynamics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir-model-in-homogeneous-population">SIR model in homogeneous population</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#your-turn">Your Turn!</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seir-susceptible-exposed-infectious-recovered-dynamics">[SEIR] Susceptible-Exposed-Infectious-Recovered Dynamics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">SIR model in homogeneous population</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rethinking-our-code">Rethinking our code…</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#epidemic-dynamics-on-networks">Epidemic Dynamics on Networks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-time">Next time…</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references-and-further-resources">References and further resources:</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="class-17-dynamics-on-networks-2-compartmental-models">
<h1>Class 17: Dynamics on Networks 2 — Compartmental Models<a class="headerlink" href="#class-17-dynamics-on-networks-2-compartmental-models" title="Link to this heading">#</a></h1>
<p>Goal of today’s class:</p>
<ol class="arabic simple">
<li><p>Adapt our notion of dynamics on networks to spreading models</p></li>
<li><p>Define compartmental models (SI, SIS, SIR)</p></li>
<li><p>Explore core results in spreading models on networks</p></li>
</ol>
<p><em>Acknowledgement: Some of the material in this lesson is based on materials by Matteo Chinazzi and Qian Zhang.</em></p>
<hr class="docutils" />
<ol class="arabic simple">
<li><p>Come in. Sit down. Open Teams.</p></li>
<li><p>Find your notebook in your /Class_17/ folder.</p></li>
</ol>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">rc</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">axisbelow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;figure&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">&#39;savefig&#39;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="mathematical-models-of-epidemic-spreading">
<h2>Mathematical Models of Epidemic Spreading<a class="headerlink" href="#mathematical-models-of-epidemic-spreading" title="Link to this heading">#</a></h2>
<p>As we learned last class, we can model dynamical processes on networks in a wide variety of contexts in complex systems science. One area where Network Science has has the most success in application is in <strong>epidemic dynamics</strong>, which stand out due to their relevance in public health, ecology, and sociotechnical systems. Networks serve as natural substrates for modeling the spread of infectious diseases, as they capture the underlying structure of interactions—whether physical, social, or digital—through which contagion propagates.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&quot;I simply wish that, in a matter which so closely concerns the wellbeing of the human race, no decision shall be made without all the knowledge which a little analysis and calculation can provide.&quot;

    - Daniel Bernoulli (1760)
</pre></div>
</div>
<p><img alt="" src="../../_images/bernoulli.png" /></p>
<p><em>From: Dietz, K. &amp; Heesterbeek, J. Bernoulli was ahead of modern epidemiology. Nature 408, 513–514 (2000).</em> <a class="reference external" href="https://doi.org/10.1038/35046270">https://doi.org/10.1038/35046270</a></p>
<p>Daniel Bernoulli is often credited for his 1760 observation about the potential effectiveness of smallpox inoculation for reducing risk of death. This led to one (of many) scientific argument between Bernoulli and Jean Le Rond d’Alembert in the late 1700s. Today, we see Bernoulli’s work as one of the first mathematical models in epidemiology (followed, in some sense, by Kermack and McKendrick, nearly 200 years later in 1927).</p>
</section>
<hr class="docutils" />
<section id="spreading-models-what-are-they-how-do-they-work-why-do-we-use-them">
<h2>Spreading Models: What are they, how do they work, why do we use them?<a class="headerlink" href="#spreading-models-what-are-they-how-do-they-work-why-do-we-use-them" title="Link to this heading">#</a></h2>
<p>At the heart of epidemic dynamics are <strong>compartmental models</strong>, which classify individuals into states such as susceptible (S), infected (I), and recovered (R) (hospitalized, latent, exposed, quarantined, etc. etc.), allowing us to model a range of characteristic heterogeneities in individual behavior. By combining these models with network structures, we gain insights into how local interactions influence global phenomena, such as outbreak size, speed of spread, and the effectiveness of interventions.</p>
<p>This chapter introduces key concepts in epidemic dynamics on networks, starting with a review of <strong>basic compartmental models (SIR, SIS, SEIR)</strong>. We then explore how these models are adapted to networked settings, focusing on (if time):</p>
<ol class="arabic simple">
<li><p><strong>The role of network topology</strong>: How properties such as degree distribution, clustering, and community structure impact disease dynamics.</p></li>
<li><p><strong>Threshold phenomena</strong>: Conditions under which an epidemic transitions from local containment to widespread outbreak.</p></li>
<li><p><strong>Dynamical measures</strong>: Metrics such as the basic reproduction number (R_0), network transmissibility, and epidemic size.</p></li>
<li><p><strong>Intervention strategies</strong>: The effects of targeted vaccination, quarantine, and network rewiring on mitigating disease spread.</p></li>
</ol>
<p><strong>Central questions to answer:</strong></p>
<ul class="simple">
<li><p>How do contagions spread in populations?</p></li>
<li><p>Will a disease become an epidemic?</p></li>
<li><p>Who are the best people to vaccinate?</p></li>
</ul>
<hr class="docutils" />
<p>Some important references from the article above:</p>
<ol class="arabic simple">
<li><p>Dietz, K. &amp; Heesterbeek, J. Bernoulli was ahead of modern epidemiology. <em>Nature</em> 408, 513–514 (2000). <a class="reference external" href="https://doi.org/10.1038/35046270">https://doi.org/10.1038/35046270</a></p></li>
<li><p>Bernoulli, D. Mém. Math. Phys. Acad. R. Sci. Paris 1–45 (1766); English translation by Bradley, L. in <em>Smallpox Inoculation: An Eighteenth Century Mathematical Controversy (Adult Education Department, Nottingham, 1971)</em>.</p></li>
<li><p>Anderson, R. M. &amp; May, R. M. Infectious Diseases of Humans — <em>Dynamics and Control</em> (Oxford University Press, Oxford, 1991).</p></li>
<li><p>Dietz, K. <em>Stat. Meth. Med. Res.</em> 2, 23–41 (1993).</p></li>
<li><p>D’Alembert, J. Opuscules Mathématiques, t. II (Paris, David, 1761).</p></li>
<li><p>Kermack William Ogilvy &amp; McKendrick A.G. (1927). A contribution to the mathematical theory of epidemics. <em>Proc. R. Soc. Lond.</em> A115700–721 <a class="reference external" href="http://doi.org/10.1098/rspa.1927.0118">http://doi.org/10.1098/rspa.1927.0118</a>.</p></li>
</ol>
<hr class="docutils" />
<section id="basic-component-of-compartmental-models">
<h3>Basic Component of Compartmental Models<a class="headerlink" href="#basic-component-of-compartmental-models" title="Link to this heading">#</a></h3>
<section id="i-individuals-in-are-grouped-by-disease-status">
<h4>I. Individuals in are grouped by  disease status:<a class="headerlink" href="#i-individuals-in-are-grouped-by-disease-status" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>[<strong>S</strong>] – Susceptible</p>
<ul>
<li><p>Individuals who have not yet been exposed to the disease but are at risk of becoming infected if they come into contact with an infectious individual.</p></li>
</ul>
</li>
<li><p>[<strong>I</strong>] – Infectious</p>
<ul>
<li><p>Individuals in this compartment are actively infected and capable of transmitting the disease to susceptible individuals.</p></li>
</ul>
</li>
<li><p>[<strong>R</strong>] – Recovered (or Removed)</p>
<ul>
<li><p>Individuals who have recovered from the disease and are assumed to be immune to future infections.</p></li>
</ul>
</li>
<li><p>And many others, depending on the disease dynamics in question (e.g. <strong>V</strong>accinated, <strong>Q</strong>uarantined, <strong>H</strong>ospitalized, <strong>L</strong>atent, <strong>A</strong>symptomatic, etc.)</p></li>
</ul>
<p><em>Note: Typically we assume constant population (e.g., <span class="math notranslate nohighlight">\(N = S+I+R\)</span>) in these models.</em></p>
</section>
<section id="ii-transition-between-compartments">
<h4>II. Transition between compartments:<a class="headerlink" href="#ii-transition-between-compartments" title="Link to this heading">#</a></h4>
<p>Two main types:</p>
<ol class="arabic simple">
<li><p>Transitions that are based on “<strong>interaction</strong>” (i.e., “contagion”)</p>
<ul class="simple">
<li><p>Susceptibles individuals become infectious by interacting with infectious (S + I -&gt; 2I)</p></li>
</ul>
</li>
<li><p>Transitions that are “<strong>spontaneous</strong>”</p>
<ul class="simple">
<li><p>Infectious individuals can become recovered on their own (i.e., no interaction; I -&gt; R)</p></li>
</ul>
</li>
</ol>
</section>
<section id="iii-the-dynamical-process-itself">
<h4>III. The dynamical process itself<a class="headerlink" href="#iii-the-dynamical-process-itself" title="Link to this heading">#</a></h4>
<p>Intuitively this should be a function of:</p>
<ul class="simple">
<li><p>The number of infected individuals in the population</p></li>
<li><p>The probability of infection given an infected contact</p></li>
<li><p>The number of contacts with infectious individuals</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="iv-mixing-method-homogeneous-heterogeneous-etc">
<h4>IV. Mixing Method: Homogeneous, Heterogeneous, etc.<a class="headerlink" href="#iv-mixing-method-homogeneous-heterogeneous-etc" title="Link to this heading">#</a></h4>
<p>In the <strong>homogeneous mixing</strong> case, we assume a fully “mixed” population (good approximation for some diseases), where every individual in the population has an equal chance of coming into contact with others. The <em>force of infection</em> (<span class="math notranslate nohighlight">\(\lambda\)</span>) is the per capita rate at which susceptible individuals acquire an infectious disease: <span class="math notranslate nohighlight">\(\lambda = \dfrac{\mathrm{the\; number\; of\; infections}}{\mathrm{the\; number\; of\; susceptible\; person\; exposed}\times\mathrm{duration\; of\; exposed}}\)</span>.</p>
<p>In this case, infection follows a <em>mass-action law</em>. Suppose <span class="math notranslate nohighlight">\(N\)</span> is the total population, <span class="math notranslate nohighlight">\(I\)</span> is the number of infections, <span class="math notranslate nohighlight">\(\beta\)</span> is the transmission rate (<span class="math notranslate nohighlight">\(\beta^{-1}\)</span> the period of infection); in this case, the force of infection <span class="math notranslate nohighlight">\(\lambda = \beta\dfrac{I}{N}\)</span>.</p>
<p>In <strong>heterogeneous mixing</strong>, the well-mixed approximation becomes relaxed, and we consider explicitly the connectivity prescribed by a network, <span class="math notranslate nohighlight">\(G\)</span>. Here, we assume a <em>degree-class approximation</em> (sometimes described as an <em>annealed</em> approximation).</p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="si-susceptible-infectious-dynamics">
<h2>[SI] Susceptible-Infectious Dynamics<a class="headerlink" href="#si-susceptible-infectious-dynamics" title="Link to this heading">#</a></h2>
<p>This is probably the simplest model of disease dynamics, where infection is permanent.</p>
<p><img alt="" src="../../_images/compartments_SI.png" /></p>
<p>In a homogeneous population:</p>
<p><span class="math notranslate nohighlight">\(
\begin{align*}
S(t+dt) \; =&amp; \; S(t) - \beta S(t)\frac{I(t)}{N}dt \\
I(t+dt) \; =&amp; \; I(t) + \beta S(t)\frac{I(t)}{N}dt \\
\end{align*}
\)</span></p>
<p><strong>Notes:</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\frac{S}{N}\)</span> is the probability of meeting a susceptible individual per unit time</p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{IS}{N}\)</span> is the average number of susceptibles that infected individuals meet per unit time</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\frac{IS}{N}\)</span> is the average number of susceptibles that become infected per unit time</p></li>
</ul>
<p>In the continuous limit <span class="math notranslate nohighlight">\(dt \rightarrow 0\)</span>,</p>
<p><span class="math notranslate nohighlight">\(
\begin{align*}
d_t S \; =&amp; \; -\beta S \frac{I}{N} \quad d_t s \; = \; -\beta s i \quad s \; = \; \frac{S}{N} \\
d_t I \; =&amp; \; \beta S\frac{I}{N} \qquad d_t i \; = \; \beta s i \qquad i \; = \; \frac{I}{N} \\
\end{align*}
\)</span></p>
<p>with <span class="math notranslate nohighlight">\( s = 1 - i \)</span>. We have,</p>
<p><span class="math notranslate nohighlight">\(di = \beta i(1-i) dt\)</span> and</p>
<p><span class="math notranslate nohighlight">\(\int_{i_0}^{i} \frac{di'}{i' (1-i')} = \beta\int_{t_0}^{t} dt\)</span>.</p>
<p>So the analytical solution is: <span class="math notranslate nohighlight">\(i(t) = \frac{1}{1 + (1-i_0) e^{-\beta t}}\)</span> as <span class="math notranslate nohighlight">\(t\rightarrow\infty\)</span>, and</p>
<p><span class="math notranslate nohighlight">\(i(\infty)\rightarrow 1 \qquad s(\infty)\rightarrow 0\)</span>.</p>
<hr class="docutils" />
<section id="sis-susceptible-infectious-susceptible-dynamics">
<h3>[SIS] Susceptible-Infectious-Susceptible Dynamics<a class="headerlink" href="#sis-susceptible-infectious-susceptible-dynamics" title="Link to this heading">#</a></h3>
<p>SIS dynamics adds a “recovery” process, but there is no permanent immunization.</p>
<p><img alt="" src="../../_images/compartments_SIS.png" /></p>
<section id="sis-in-homogeneous-populations">
<h4>SIS in Homogeneous Populations<a class="headerlink" href="#sis-in-homogeneous-populations" title="Link to this heading">#</a></h4>
<p><span class="math notranslate nohighlight">\(
\begin{align*}
S(t+dt) \; =&amp; \; S(t) - \beta S(t)\frac{I(t)}{N}dt + \mu I(t)dt\\
I(t+dt) \; =&amp; \; I(t) + \beta S(t)\frac{I(t)}{N}dt - \mu I(t)dt \\
\end{align*}
\)</span></p>
<p>or equivalently,</p>
<p><span class="math notranslate nohighlight">\(
\begin{align*}
d_t s(t) \; =&amp; \; - \beta s(t)i(t) + \mu i(t)\\
d_t i(t) \; =&amp; \; \beta s(t)i(t) - \mu i(t) \\
\end{align*}
\)</span></p>
<p>In early time dynamics, the number of infectious individuals is small with respect to the population size (<span class="math notranslate nohighlight">\(s \sim 1\)</span>) (which makes sense). We can therefore linearize the equation <span class="math notranslate nohighlight">\(d_{t} i = \beta i - \mu i = (\beta - \mu) i\)</span>.</p>
<p>We therefore have <strong>epidemic threshold</strong> <span class="math notranslate nohighlight">\(\beta - \mu &gt; 0\)</span>  or <span class="math notranslate nohighlight">\(\dfrac{\beta}{\mu}&gt;1\)</span>.</p>
</section>
<section id="basic-reproductive-number-r-0">
<h4>Basic Reproductive Number, <span class="math notranslate nohighlight">\(R_0\)</span><a class="headerlink" href="#basic-reproductive-number-r-0" title="Link to this heading">#</a></h4>
<p>The basic reproductive number, <span class="math notranslate nohighlight">\(R_0\)</span> is a central concept in epidemiology; it is the average number of secondary infections generated by a initial infection in a fully uninfected population. Its precise form depends on the epidemic dynamics themselves (i.e., for the SIS model, <span class="math notranslate nohighlight">\(R_0 = \dfrac{\beta}{\mu}\)</span>).</p>
<p>The analytical solution: <span class="math notranslate nohighlight">\(i(t) = \dfrac{\beta - \mu}{\beta + c e^{-\mu(R_0 -1)t}}\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(R_0&lt;1\)</span>, <span class="math notranslate nohighlight">\(i(\infty) = 0\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(R_0&gt;1\)</span>, <span class="math notranslate nohighlight">\(i(\infty) = 1 - \dfrac{1}{R_0}\)</span>, which is an endemic state.</p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">deterministic_epidemic_sis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S_o</span><span class="p">,</span> <span class="n">I_o</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a deterministic epidemic model using the SIS</span>
<span class="sd">    (Susceptible-Infected-Recovered) framework.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    N (int): Total population size, assumed to be constant throughout the simulation.</span>
<span class="sd">    S_o (int): Initial number of susceptible individuals.</span>
<span class="sd">    I_o (int): Initial number of infected individuals.</span>
<span class="sd">    beta (float): Transmission rate of the infection.</span>
<span class="sd">    mu (float): Recovery rate of the infection.</span>
<span class="sd">    T (int): Total time steps for the simulation.</span>

<span class="sd">    Returns:</span>
<span class="sd">    tuple of lists: Three lists representing the number of Susceptible (S),</span>
<span class="sd">                    Infected (I) individuals at each time step over the</span>
<span class="sd">                    course of the simulation.</span>

<span class="sd">    If `beta` or `mu` are not provided as floats, they are converted to floats.</span>

<span class="sd">    Example:</span>
<span class="sd">        N = 1000</span>
<span class="sd">        S_o = 990</span>
<span class="sd">        I_o = 10</span>
<span class="sd">        beta = 0.3</span>
<span class="sd">        mu = 0.1</span>
<span class="sd">        T = 100</span>
<span class="sd">        S, I = deterministic_epidemic_sis(N, S_o, I_o, beta, mu, T)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Ensure beta and mu are floats for consistency in calculations</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>

    <span class="c1"># Initialize time step counter</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Initialize lists for storing the S, I, R values at each time step</span>
    <span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">S_o</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="c1"># Susceptible population over time</span>
    <span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="n">I_o</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="c1"># Infected population over time</span>
       
    <span class="c1"># Iterate through each time step</span>
    <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Update the susceptible population based on the SIR model</span>
        <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">beta</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">/</span><span class="n">N</span> <span class="o">+</span> <span class="n">mu</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

        <span class="c1"># Update the infected population based on new infections and recoveries</span>
        <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">mu</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">/</span><span class="n">N</span>

        <span class="c1"># Move to the next time step</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="mi">1</span>


    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">I</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S_o</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">I_o</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">S_o</span> <span class="o">+</span> <span class="n">I_o</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.009</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="n">S</span><span class="p">,</span> <span class="n">I</span> <span class="o">=</span> <span class="n">deterministic_epidemic_sis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S_o</span><span class="p">,</span> <span class="n">I_o</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">S</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;teal&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">I</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I&#39;</span><span class="p">)</span> 

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7b286e6bcb1d0b71f6ec12ccc42d85dbfb53f1ffbab110a0ff8963eceeb81dae.png" src="../../_images/7b286e6bcb1d0b71f6ec12ccc42d85dbfb53f1ffbab110a0ff8963eceeb81dae.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">stochastic_epidemic_sis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S_o</span><span class="p">,</span> <span class="n">I_o</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a deterministic epidemic model using the SIR</span>
<span class="sd">    (Susceptible-Infected-Recovered) framework.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    N (int): Total population size, assumed to be constant throughout the simulation.</span>
<span class="sd">    S_o (int): Initial number of susceptible individuals.</span>
<span class="sd">    I_o (int): Initial number of infected individuals.</span>
<span class="sd">    beta (float): Transmission rate of the infection.</span>
<span class="sd">    mu (float): Recovery rate of the infection.</span>
<span class="sd">    T (int): Total time steps for the simulation.</span>

<span class="sd">    Returns:</span>
<span class="sd">    tuple of lists: Three lists representing the number of Susceptible (S),</span>
<span class="sd">                    Infected (I), and Recovered/Removed (R) individuals </span>
<span class="sd">                    at each time step over the course of the simulation.</span>

<span class="sd">    The function iteratively updates the S, I, and R compartments at each timestep</span>
<span class="sd">    using the SIR model equations:</span>
<span class="sd">        - S(t+1) = S(t) - beta * S(t) * I(t) / N</span>
<span class="sd">        - I(t+1) = I(t) + beta * S(t) * I(t) / N - mu * I(t)</span>
<span class="sd">        - R(t+1) = R(t) + mu * I(t)</span>

<span class="sd">    If `beta` or `mu` are not provided as floats, they are converted to floats.</span>

<span class="sd">    Example:</span>
<span class="sd">        N = 1000</span>
<span class="sd">        S_o = 990</span>
<span class="sd">        I_o = 10</span>
<span class="sd">        beta = 0.3</span>
<span class="sd">        mu = 0.1</span>
<span class="sd">        T = 100</span>
<span class="sd">        S, I, R = deterministic_epidemic(N, S_o, I_o, beta, mu, T)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Ensure beta and mu are floats for consistency in calculations</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>

    <span class="c1"># Initialize time step counter</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Initialize lists for storing the S, I values at each time step</span>
    <span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">S_o</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="c1"># Susceptible population over time</span>
    <span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="n">I_o</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="c1"># Infected population over time</span>
       
    <span class="c1"># Iterate through each time step</span>
    <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">force_of_inf</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">/</span> <span class="n">N</span>

        <span class="c1"># Sample transitions from susceptible to infectious</span>
        <span class="n">S_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">force_of_inf</span><span class="p">)</span>

        <span class="c1"># Sample transitions from infectious to susceptible</span>
        <span class="n">I_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">mu</span><span class="p">)</span>
        
        <span class="c1"># Update the susceptible population based on the SIR model</span>
        <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">S_out</span> <span class="o">+</span> <span class="n">I_out</span>

        <span class="c1"># Update the infected population based on new infections and recoveries</span>
        <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">I_out</span> <span class="o">+</span> <span class="n">S_out</span>

        <span class="c1"># Move to the next time step</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="mi">1</span>


    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">I</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S_o</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">I_o</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">S_o</span> <span class="o">+</span> <span class="n">I_o</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.009</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="n">S</span><span class="p">,</span><span class="n">I</span> <span class="o">=</span> <span class="n">stochastic_epidemic_sis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S_o</span><span class="p">,</span> <span class="n">I_o</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">S</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;teal&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">I</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I&#39;</span><span class="p">)</span> 

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d97354c83d556ef18225d84f110b6bc6e35a55a8226d20c75c5519aeaf748d6f.png" src="../../_images/d97354c83d556ef18225d84f110b6bc6e35a55a8226d20c75c5519aeaf748d6f.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="sir-susceptible-infectious-recovered-dynamics">
<h3>[SIR] Susceptible-Infectious-Recovered Dynamics<a class="headerlink" href="#sir-susceptible-infectious-recovered-dynamics" title="Link to this heading">#</a></h3>
<p>In SIR dynamics, we add a recovery (R) compartment, which draws individuals from the infectious (I) compartment, making them ineligible for future infection (i.e., permanently immunized).</p>
<p><img alt="" src="../../_images/compartments_SIR.png" /></p>
</section>
<section id="sir-model-in-homogeneous-population">
<h3>SIR model in homogeneous population<a class="headerlink" href="#sir-model-in-homogeneous-population" title="Link to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(
\begin{align*}
d_t s(t) \; =&amp; \; - \beta s(t)i(t) \\
d_t i(t) \; =&amp; \; \beta s(t)i(t) - \mu i(t) \\
d_t r(t) \; =&amp; \; \mu i(t)
\end{align*}
\)</span></p>
<p><strong>Assumptions:</strong> In the early time dynamics,</p>
<ul class="simple">
<li><p>the number of infectious is small respect to the population size (<span class="math notranslate nohighlight">\(s \sim 1\)</span>, <span class="math notranslate nohighlight">\(i \sim 0\)</span>)</p></li>
<li><p>we can linearize the equation <span class="math notranslate nohighlight">\(d_{i}t = \beta i - \mu i = (\beta - \mu) i\)</span></p></li>
<li><p>so we have an <strong>epidemic threshold</strong> <span class="math notranslate nohighlight">\(\beta - \mu &gt; 0\)</span> or <span class="math notranslate nohighlight">\(R_0=\frac{\beta}{\mu}&gt;1\)</span></p></li>
</ul>
</section>
<section id="your-turn">
<h3>Your Turn!<a class="headerlink" href="#your-turn" title="Link to this heading">#</a></h3>
<p>Adapt your deterministic SI function to accommodate the R compartment. Plot an SIR example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">deterministic_epidemic_sir</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S_o</span><span class="p">,</span> <span class="n">I_o</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a deterministic epidemic model using the SIR</span>
<span class="sd">    (Susceptible-Infected-Recovered) framework.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    N (int): Total population size, assumed to be constant throughout the simulation.</span>
<span class="sd">    S_o (int): Initial number of susceptible individuals.</span>
<span class="sd">    I_o (int): Initial number of infected individuals.</span>
<span class="sd">    beta (float): Transmission rate of the infection.</span>
<span class="sd">    mu (float): Recovery rate of the infection.</span>
<span class="sd">    T (int): Total time steps for the simulation.</span>

<span class="sd">    Returns:</span>
<span class="sd">    tuple of lists: Three lists representing the number of Susceptible (S),</span>
<span class="sd">                    Infected (I), and Recovered/Removed (R) individuals </span>
<span class="sd">                    at each time step over the course of the simulation.</span>

<span class="sd">    The function iteratively updates the S, I, and R compartments at each timestep</span>
<span class="sd">    using the SIR model equations:</span>
<span class="sd">        - S(t+1) = S(t) - beta * S(t) * I(t) / N</span>
<span class="sd">        - I(t+1) = I(t) + beta * S(t) * I(t) / N - mu * I(t)</span>
<span class="sd">        - R(t+1) = R(t) + mu * I(t)</span>

<span class="sd">    If `beta` or `mu` are not provided as floats, they are converted to floats.</span>

<span class="sd">    Example:</span>
<span class="sd">        N = 1000</span>
<span class="sd">        S_o = 990</span>
<span class="sd">        I_o = 10</span>
<span class="sd">        beta = 0.3</span>
<span class="sd">        mu = 0.1</span>
<span class="sd">        T = 100</span>
<span class="sd">        S, I, R = deterministic_epidemic(N, S_o, I_o, beta, mu, T)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Ensure beta and mu are floats for consistency in calculations</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>

    <span class="k">pass</span>

    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">R</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">deterministic_epidemic_sir</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S_o</span><span class="p">,</span> <span class="n">I_o</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a deterministic epidemic model using the SIR</span>
<span class="sd">    (Susceptible-Infected-Recovered) framework.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    N (int): Total population size, assumed to be constant throughout the simulation.</span>
<span class="sd">    S_o (int): Initial number of susceptible individuals.</span>
<span class="sd">    I_o (int): Initial number of infected individuals.</span>
<span class="sd">    beta (float): Transmission rate of the infection.</span>
<span class="sd">    mu (float): Recovery rate of the infection.</span>
<span class="sd">    T (int): Total time steps for the simulation.</span>

<span class="sd">    Returns:</span>
<span class="sd">    tuple of lists: Three lists representing the number of Susceptible (S),</span>
<span class="sd">                    Infected (I), and Recovered/Removed (R) individuals </span>
<span class="sd">                    at each time step over the course of the simulation.</span>

<span class="sd">    The function iteratively updates the S, I, and R compartments at each timestep</span>
<span class="sd">    using the SIR model equations:</span>
<span class="sd">        - S(t+1) = S(t) - beta * S(t) * I(t) / N</span>
<span class="sd">        - I(t+1) = I(t) + beta * S(t) * I(t) / N - mu * I(t)</span>
<span class="sd">        - R(t+1) = R(t) + mu * I(t)</span>

<span class="sd">    If `beta` or `mu` are not provided as floats, they are converted to floats.</span>

<span class="sd">    Example:</span>
<span class="sd">        N = 1000</span>
<span class="sd">        S_o = 990</span>
<span class="sd">        I_o = 10</span>
<span class="sd">        beta = 0.3</span>
<span class="sd">        mu = 0.1</span>
<span class="sd">        T = 100</span>
<span class="sd">        S, I, R = deterministic_epidemic(N, S_o, I_o, beta, mu, T)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Ensure beta and mu are floats for consistency in calculations</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>

    <span class="c1"># Initialize time step counter</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Initialize lists for storing the S, I, R values at each time step</span>
    <span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">S_o</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="c1"># Susceptible population over time</span>
    <span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="n">I_o</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="c1"># Infected population over time</span>
    <span class="n">R</span> <span class="o">=</span> <span class="p">[(</span><span class="n">N</span> <span class="o">-</span> <span class="n">S_o</span> <span class="o">-</span> <span class="n">I_o</span><span class="p">)]</span><span class="o">*</span><span class="n">T</span> <span class="c1"># Recovered population over time</span>
       
    <span class="c1"># Iterate through each time step</span>
    <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Update the susceptible population based on the SIR model</span>
        <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">beta</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">/</span><span class="n">N</span>

        <span class="c1"># Update the infected population based on new infections and recoveries</span>
        <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">mu</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">/</span><span class="n">N</span>

        <span class="c1"># Update the recovered population based on the recovery rate</span>
        <span class="n">R</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">mu</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

        <span class="c1"># Move to the next time step</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="mi">1</span>


    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">R</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S_o</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">I_o</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">R_o</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">S_o</span> <span class="o">+</span> <span class="n">I_o</span> <span class="o">+</span> <span class="n">R_o</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="n">S</span><span class="p">,</span><span class="n">I</span><span class="p">,</span><span class="n">R</span> <span class="o">=</span> <span class="n">deterministic_epidemic_sir</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S_o</span><span class="p">,</span> <span class="n">I_o</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">S</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;teal&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">I</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">R</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R&#39;</span><span class="p">)</span> 

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2adb4f16ed24b58255e4f8fe100443bb67d0df749f6b68ada06f35d4bf9dd3a8.png" src="../../_images/2adb4f16ed24b58255e4f8fe100443bb67d0df749f6b68ada06f35d4bf9dd3a8.png" />
</div>
</div>
</section>
<section id="seir-susceptible-exposed-infectious-recovered-dynamics">
<h3>[SEIR] Susceptible-Exposed-Infectious-Recovered Dynamics<a class="headerlink" href="#seir-susceptible-exposed-infectious-recovered-dynamics" title="Link to this heading">#</a></h3>
<p>In SEIR dynamics, we add an exposed (E) compartment, which draws individuals from the susceptible (S) compartment via interaction with infectious compartment, then leading to a spontaneous transition to infectious (I) with probability <span class="math notranslate nohighlight">\(\epsilon\)</span>.</p>
<p><img alt="" src="../../_images/compartments_SEIR.png" /></p>
</section>
<section id="id1">
<h3>SIR model in homogeneous population<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(
\begin{align*}
d_t s(t) \; =&amp; \; - \beta s(t)i(t) \\
d_t i(t) \; =&amp; \; \beta s(t)i(t) - \mu i(t) \\
d_t r(t) \; =&amp; \; \mu i(t)
\end{align*}
\)</span></p>
<p><strong>Assumptions:</strong> In the early time dynamics,</p>
<ul class="simple">
<li><p>the number of infectious is small respect to the population size (<span class="math notranslate nohighlight">\(s \sim 1\)</span>, <span class="math notranslate nohighlight">\(i \sim 0\)</span>)</p></li>
<li><p>we can linearize the equation <span class="math notranslate nohighlight">\(d_{i}t = \beta i - \mu i = (\beta - \mu) i\)</span></p></li>
<li><p>so we have an <strong>epidemic threshold</strong> <span class="math notranslate nohighlight">\(\beta - \mu &gt; 0\)</span> or <span class="math notranslate nohighlight">\(R_0=\frac{\beta}{\mu}&gt;1\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">deterministic_epidemic_seir</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S_o</span><span class="p">,</span> <span class="n">E_o</span><span class="p">,</span> <span class="n">I_o</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">epsi</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a deterministic epidemic model using the SEIR</span>
<span class="sd">    (Susceptible-Infected-Recovered) framework.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    N (int): Total population size, assumed to be constant throughout the simulation.</span>
<span class="sd">    S_o (int): Initial number of susceptible individuals.</span>
<span class="sd">    E_o (int): Initial number of exposed individuals.</span>
<span class="sd">    I_o (int): Initial number of infected individuals.</span>
<span class="sd">    beta (float): Transmission rate of the infection.</span>
<span class="sd">    mu (float): Recovery rate of the infection.</span>
<span class="sd">    epsi (float): Transition from exposed to infectious.</span>
<span class="sd">    T (int): Total time steps for the simulation.</span>

<span class="sd">    Returns:</span>
<span class="sd">    tuple of lists: Four lists representing the number of Susceptible (S),</span>
<span class="sd">                    Exposed (E), Infected (I), and Recovered/Removed (R) individuals </span>
<span class="sd">                    at each time step over the course of the simulation.</span>

<span class="sd">    The function iteratively updates the S, I, and R compartments at each timestep</span>
<span class="sd">    using the SIR model equations:</span>
<span class="sd">        - S(t+1) = S(t) - beta * S(t) * I(t) / N</span>
<span class="sd">        - E(t+1) = S(t) + beta * S(t) * I(t) / N - mu * I(t)</span>
<span class="sd">        - I(t+1) = I(t) + epsilon * E(t) - mu * I(t)</span>
<span class="sd">        - R(t+1) = R(t) + mu * I(t)</span>

<span class="sd">    If `beta` or `mu` or `epsil` are not provided as floats, they are converted to floats.</span>

<span class="sd">    Example:</span>
<span class="sd">        N = 1000</span>
<span class="sd">        S_o = 980</span>
<span class="sd">        E_o = 10</span>
<span class="sd">        I_o = 10</span>
<span class="sd">        beta = 0.2</span>
<span class="sd">        mu = 0.01</span>
<span class="sd">        epsi = 0.03</span>
<span class="sd">        T = 2000</span>
<span class="sd">        S, E, I, R = deterministic_epidemic(N, S_o, E_o, I_o, beta, mu, epsi, T)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Ensure beta and mu and epsi are floats for consistency in calculations</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">epsi</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">epsi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">epsi</span><span class="p">)</span>

    <span class="c1"># Initialize time step counter</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Initialize lists for storing the S, I, R values at each time step</span>
    <span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">S_o</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="c1"># Susceptible population over time</span>
    <span class="n">E</span> <span class="o">=</span> <span class="p">[</span><span class="n">E_o</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="c1"># Exposed population over time</span>
    <span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="n">I_o</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="c1"># Infected population over time</span>
    <span class="n">R</span> <span class="o">=</span> <span class="p">[(</span><span class="n">N</span> <span class="o">-</span> <span class="n">S_o</span> <span class="o">-</span> <span class="n">E_o</span> <span class="o">-</span> <span class="n">I_o</span><span class="p">)]</span><span class="o">*</span><span class="n">T</span> <span class="c1"># Recovered population over time</span>
       
    <span class="c1"># Iterate through each time step</span>
    <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Update the susceptible population based on the SIR model</span>
        <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">beta</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">*</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">/</span><span class="n">N</span>

        <span class="c1"># Update the infected population based on new infections and recoveries</span>
        <span class="n">E</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">epsi</span><span class="o">*</span><span class="n">E</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">beta</span><span class="o">*</span><span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">/</span><span class="n">N</span>

        <span class="c1"># Update the infected population based on new infections and recoveries</span>
        <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">mu</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">epsi</span><span class="o">*</span><span class="n">E</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

        <span class="c1"># Update the recovered population based on the recovery rate</span>
        <span class="n">R</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">mu</span><span class="o">*</span><span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>

        <span class="c1"># Move to the next time step</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="mi">1</span>


    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">R</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">stochastic_epidemic_seir</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S_o</span><span class="p">,</span> <span class="n">E_o</span><span class="p">,</span> <span class="n">I_o</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">epsi</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulates a stochastic epidemic model using the SEIR</span>
<span class="sd">    (Susceptible-Exposed-Infected-Recovered) framework.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    N (int): Total population size, assumed to be constant throughout the simulation.</span>
<span class="sd">    S_o (int): Initial number of susceptible individuals.</span>
<span class="sd">    E_o (int): Initial number of exposed (but not yet infectious) individuals.</span>
<span class="sd">    I_o (int): Initial number of infected individuals.</span>
<span class="sd">    beta (float): Transmission rate of the infection.</span>
<span class="sd">    mu (float): Recovery rate of the infection.</span>
<span class="sd">    epsi (float): Rate at which exposed individuals become infectious.</span>
<span class="sd">    T (int): Total time steps for the simulation.</span>

<span class="sd">    Returns:</span>
<span class="sd">    tuple of lists: Four lists representing the number of Susceptible (S),</span>
<span class="sd">                    Exposed (E), Infected (I), and Recovered (R) </span>
<span class="sd">                    individuals at each time step over the course of</span>
<span class="sd">                    the simulation.</span>

<span class="sd">    The function iteratively updates the S, E, I, and R compartments at each</span>
<span class="sd">    time step using a stochastic approach based on the SEIR model:</span>
<span class="sd">        - S -&gt; E: New exposures occur with probability based on the</span>
<span class="sd">                  transmission rate and current infected count.</span>
<span class="sd">        - E -&gt; I: Exposed individuals become infectious at a rate `epsi`.</span>
<span class="sd">        - I -&gt; R: Infected individuals recover at a rate `mu`.</span>

<span class="sd">    Example:</span>
<span class="sd">        N = 1000</span>
<span class="sd">        S_o = 990</span>
<span class="sd">        E_o = 5</span>
<span class="sd">        I_o = 5</span>
<span class="sd">        beta = 0.3</span>
<span class="sd">        mu = 0.1</span>
<span class="sd">        epsi = 0.2</span>
<span class="sd">        T = 100</span>
<span class="sd">        S, E, I, R = stochastic_epidemic(N, S_o, E_o, I_o, beta, mu, epsi, T)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Ensure beta, mu, and epsi are floats for consistency in calculations</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">beta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">epsi</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">epsi</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">epsi</span><span class="p">)</span>

    <span class="c1"># Initialize time step counter</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Initialize lists for storing the S, E, I, and R values at each time step</span>
    <span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">S_o</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span>  <span class="c1"># Susceptible population over time</span>
    <span class="n">E</span> <span class="o">=</span> <span class="p">[</span><span class="n">E_o</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span>  <span class="c1"># Exposed (latent) population over time</span>
    <span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="n">I_o</span><span class="p">]</span> <span class="o">*</span> <span class="n">T</span>  <span class="c1"># Infected population over time</span>
    <span class="n">R</span> <span class="o">=</span> <span class="p">[(</span><span class="n">N</span> <span class="o">-</span> <span class="n">S_o</span> <span class="o">-</span> <span class="n">I_o</span> <span class="o">-</span> <span class="n">E_o</span><span class="p">)]</span> <span class="o">*</span> <span class="n">T</span>  <span class="c1"># Recovered population over time</span>

    <span class="c1"># Iterate through each time step</span>
    <span class="k">while</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">T</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Calculate force of infection: the probability an S individual becomes exposed</span>
        <span class="n">force_of_inf</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">/</span> <span class="n">N</span>

        <span class="c1"># Sample new infections from susceptible population</span>
        <span class="n">S_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">force_of_inf</span><span class="p">)</span>

        <span class="c1"># Sample transitions from exposed to infected</span>
        <span class="n">E_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">epsi</span><span class="p">)</span>

        <span class="c1"># Sample transitions from infected to recovered</span>
        <span class="n">I_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">mu</span><span class="p">)</span>

        <span class="c1"># Update compartment counts based on transitions</span>
        <span class="n">S</span><span class="p">[</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">S_out</span>  <span class="c1"># Susceptibles decrease by new exposures</span>
        <span class="n">E</span><span class="p">[</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">E_out</span> <span class="o">+</span> <span class="n">S_out</span>  <span class="c1"># Exposed increase by new exposures, decrease by new infections</span>
        <span class="n">I</span><span class="p">[</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="n">I_out</span> <span class="o">+</span> <span class="n">E_out</span>  <span class="c1"># Infected increase by new infections, decrease by recoveries</span>
        <span class="n">R</span><span class="p">[</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">I_out</span>  <span class="c1"># Recovered increase by new recoveries</span>
        
        <span class="c1"># Move to the next time step</span>
        <span class="n">t</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="c1"># Return the lists containing the S, E, I, and R values for each time step</span>
    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">R</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S_o</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">E_o</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">I_o</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">R_o</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">S_o</span> <span class="o">+</span> <span class="n">E_o</span> <span class="o">+</span> <span class="n">I_o</span> <span class="o">+</span> <span class="n">R_o</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">epsi</span> <span class="o">=</span> <span class="mf">0.03</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">Sd</span><span class="p">,</span><span class="n">Ed</span><span class="p">,</span><span class="n">Id</span><span class="p">,</span><span class="n">Rd</span> <span class="o">=</span> <span class="n">deterministic_epidemic_seir</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">S_o</span><span class="p">,</span> <span class="n">E_o</span><span class="p">,</span> <span class="n">I_o</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">epsi</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="n">Ss</span><span class="p">,</span><span class="n">Es</span><span class="p">,</span><span class="n">Is</span><span class="p">,</span><span class="n">Rs</span> <span class="o">=</span> <span class="n">stochastic_epidemic_seir</span><span class="p">(</span>   <span class="n">N</span><span class="p">,</span> <span class="n">S_o</span><span class="p">,</span> <span class="n">E_o</span><span class="p">,</span> <span class="n">I_o</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">epsi</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">Sd</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;teal&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;S (det)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">Ed</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;#E65D39&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E (det)&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">Id</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I (det)&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">Rd</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R (det)&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">Ss</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;teal&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;S (sto)&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">Es</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;#E65D39&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E (sto)&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">Is</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;I (sto)&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">Rs</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;R (sto)&#39;</span><span class="p">)</span> 

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;images/pngs/SEIR_det_sto.png&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">425</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;images/pdfs/SEIR_det_sto.pdf&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fd39ea4649378fac37425afc3e657c0283e5d3305b7fdfe4b9c116484e94f398.png" src="../../_images/fd39ea4649378fac37425afc3e657c0283e5d3305b7fdfe4b9c116484e94f398.png" />
</div>
</div>
<p>Compartmental models can get (and most today are!) much more complicated as more and more details are learned about the epidemic.
<img alt="" src="../../_images/complicated_compartment.png" /></p>
</section>
</section>
<hr class="docutils" />
<section id="rethinking-our-code">
<h2>Rethinking our code…<a class="headerlink" href="#rethinking-our-code" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># only S--&gt;I</span>
<span class="n">susceptible_compartment</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span>
<span class="n">infectious_compartment</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span>

<span class="n">compartments</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;S&#39;</span><span class="p">:[],</span>
                <span class="s1">&#39;I&#39;</span><span class="p">:[]}</span>

<span class="n">transmissions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;S&#39;</span><span class="p">:[</span><span class="s1">&#39;I&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;contagion&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;beta&#39;</span><span class="p">]}</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">seed_num</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">500</span>

<span class="c1"># initialize</span>
<span class="k">for</span> <span class="n">cmpt</span> <span class="ow">in</span> <span class="n">compartments</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">cmpt</span> <span class="o">==</span> <span class="n">susceptible_compartment</span><span class="p">:</span>
        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">seed_num</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">cmpt</span> <span class="o">==</span> <span class="n">infectious_compartment</span><span class="p">:</span>
        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seed_num</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># run for T timesteps</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">cmpt_from</span><span class="p">,</span> <span class="p">(</span><span class="n">cmpt_to</span><span class="p">,</span>
                    <span class="n">tranmission_type</span><span class="p">,</span>
                    <span class="n">tranmission_rate_str</span><span class="p">)</span> <span class="ow">in</span> <span class="n">transmissions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">tranmission_type</span> <span class="o">==</span> <span class="s1">&#39;contagion&#39;</span><span class="p">:</span>
            
            <span class="n">prob</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="n">tranmission_rate_str</span><span class="p">]</span> <span class="o">*</span> <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt_to</span><span class="p">][</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">N</span>
            
            <span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">compartments</span><span class="p">[</span><span class="n">cmpt_from</span><span class="p">][</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">prob</span><span class="p">)</span>

            <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt_from</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compartments</span><span class="p">[</span><span class="n">cmpt_from</span><span class="p">][</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">delta</span><span class="p">)</span>
            
            <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt_to</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compartments</span><span class="p">[</span><span class="n">cmpt_to</span><span class="p">][</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">delta</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compartments_si</span> <span class="o">=</span> <span class="n">compartments</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;teal&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Number of individuals&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">1010</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ded0b7234e9f319249fe3ac5784584c0420644dcd9b93fee4e80ef2670fac073.png" src="../../_images/ded0b7234e9f319249fe3ac5784584c0420644dcd9b93fee4e80ef2670fac073.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s define the model</span>
<span class="n">susceptible_compartment</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span>
<span class="n">infectious_compartment</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span>

<span class="n">compartments</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;S&#39;</span><span class="p">:[],</span>
                <span class="s1">&#39;I&#39;</span><span class="p">:[]</span>
                <span class="p">}</span>

<span class="n">transmissions</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;S&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;contagion&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">),</span>
                <span class="s1">&#39;I&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;spontaneous&#39;</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">)</span> 
                <span class="p">}</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
         <span class="s1">&#39;beta&#39;</span> <span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
         <span class="s1">&#39;mu&#39;</span> <span class="p">:</span> <span class="mf">0.1</span>
         <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">seed_num</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">500</span>

<span class="c1"># initialize</span>
<span class="k">for</span> <span class="n">cmpt</span> <span class="ow">in</span> <span class="n">compartments</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">cmpt</span> <span class="o">==</span> <span class="n">susceptible_compartment</span><span class="p">:</span>
        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">seed_num</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">cmpt</span> <span class="o">==</span> <span class="n">infectious_compartment</span><span class="p">:</span>
        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seed_num</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">cmpt</span> <span class="ow">in</span> <span class="n">compartments</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compartments</span><span class="p">[</span><span class="n">cmpt</span><span class="p">][</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">cmpt_from</span><span class="p">,</span> <span class="p">(</span><span class="n">cmpt_to</span><span class="p">,</span> <span class="n">tr_type</span><span class="p">,</span> <span class="n">tr_rate_str</span><span class="p">)</span> <span class="ow">in</span> <span class="n">transmissions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">tr_type</span> <span class="o">==</span> <span class="s1">&#39;contagion&#39;</span><span class="p">:</span>
            <span class="n">prob</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="n">tr_rate_str</span><span class="p">]</span> <span class="o">*</span> <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt_to</span><span class="p">][</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1">#for spontaneous transition</span>
            <span class="n">prob</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="n">tr_rate_str</span><span class="p">]</span>

        <span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">compartments</span><span class="p">[</span><span class="n">cmpt_from</span><span class="p">][</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">prob</span><span class="p">)</span>

        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt_from</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">-=</span> <span class="n">delta</span>
        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt_to</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">+=</span> <span class="n">delta</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compartments_sis</span> <span class="o">=</span> <span class="n">compartments</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;teal&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Number of individuals&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">1010</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ea856c903e205d160f52cc1a09a2593554121d69f7276a396984edd584d0ecd9.png" src="../../_images/ea856c903e205d160f52cc1a09a2593554121d69f7276a396984edd584d0ecd9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#let&#39;s define the model</span>
<span class="n">susceptible_compartment</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span>
<span class="n">infectious_compartment</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span>
<span class="n">recovered_compartment</span> <span class="o">=</span> <span class="s1">&#39;R&#39;</span>

<span class="n">compartments</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;S&#39;</span><span class="p">:[],</span>
                <span class="s1">&#39;I&#39;</span><span class="p">:[],</span>
                <span class="s1">&#39;R&#39;</span><span class="p">:[]</span>
                <span class="p">}</span>

<span class="n">transmissions</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;S&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;contagion&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">),</span>
                <span class="s1">&#39;I&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;spontaneous&#39;</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">)</span> 
                <span class="p">}</span>

<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
         <span class="s1">&#39;beta&#39;</span> <span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
         <span class="s1">&#39;mu&#39;</span> <span class="p">:</span> <span class="mf">0.1</span>
         <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">seed_num</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">500</span>

<span class="c1"># initialize</span>
<span class="k">for</span> <span class="n">cmpt</span> <span class="ow">in</span> <span class="n">compartments</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">cmpt</span> <span class="o">==</span> <span class="n">susceptible_compartment</span><span class="p">:</span>
        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">seed_num</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">cmpt</span> <span class="o">==</span> <span class="n">infectious_compartment</span><span class="p">:</span>
        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seed_num</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">cmpt</span> <span class="ow">in</span> <span class="n">compartments</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compartments</span><span class="p">[</span><span class="n">cmpt</span><span class="p">][</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">cmpt_from</span><span class="p">,</span> <span class="p">(</span><span class="n">cmpt_to</span><span class="p">,</span> <span class="n">tr_type</span><span class="p">,</span> <span class="n">tr_rate_str</span><span class="p">)</span> <span class="ow">in</span> <span class="n">transmissions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">tr_type</span> <span class="o">==</span> <span class="s1">&#39;contagion&#39;</span><span class="p">:</span>
            <span class="n">prob</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="n">tr_rate_str</span><span class="p">]</span> <span class="o">*</span> <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt_to</span><span class="p">][</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1">#for spontaneous transition</span>
            <span class="n">prob</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="n">tr_rate_str</span><span class="p">]</span>

        <span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">compartments</span><span class="p">[</span><span class="n">cmpt_from</span><span class="p">][</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">prob</span><span class="p">)</span>

        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt_from</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">-=</span> <span class="n">delta</span>
        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt_to</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">+=</span> <span class="n">delta</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compartments_sir</span> <span class="o">=</span> <span class="n">compartments</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;teal&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;R&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Number of individuals&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">1010</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5df9795a348a7fab31799b09b5689a576559153dc81118f32c6536946b037aab.png" src="../../_images/5df9795a348a7fab31799b09b5689a576559153dc81118f32c6536946b037aab.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">model_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SI&#39;</span><span class="p">,</span><span class="s1">&#39;SIS&#39;</span><span class="p">,</span><span class="s1">&#39;SIR&#39;</span><span class="p">]</span>
<span class="n">compartment_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">]</span>
<span class="n">compartment_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;teal&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;purple&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ix</span><span class="p">,</span><span class="n">compartments</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">compartments_si</span><span class="p">,</span> <span class="n">compartments_sis</span><span class="p">,</span> <span class="n">compartments_sir</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span><span class="n">comp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">compartments</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments</span><span class="p">[</span><span class="n">comp</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">compartment_colors</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span>
                    <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">compartment_labels</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span> 

    <span class="n">ax</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Number of individuals&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">1010</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">model_labels</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/058854eeb3565ee845a7e18626fd198945766d7f65467f0f1bd716e59e53016c.png" src="../../_images/058854eeb3565ee845a7e18626fd198945766d7f65467f0f1bd716e59e53016c.png" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="epidemic-dynamics-on-networks">
<h2>Epidemic Dynamics on Networks<a class="headerlink" href="#epidemic-dynamics-on-networks" title="Link to this heading">#</a></h2>
<!-- 
### SIR model on network

similar arguments to SIS model on hetergeneous networks, but with slightly different solution for the epidemic threshold:

$$R_0 = \frac{\beta}{\mu} > \frac{\langle k \rangle}{\langle k^2 \rangle - \langle k \rangle}$$

# Dynamical Processes on Networks III

# Epidemic Spreading Models (cont.)

## Immunization of heterogeneous networks

* Immunization strategies on networks:
    * to increase the immunization level of populations 
    * to decrease the chances of epidemic outbreaks.

* The weakness of scale-free networks to epidemic attacks

### random immunization (uniform immunization)
* immunize nodes randomly (according to uniform distribution)

* Let $g$ be the density of immune nodes (or probability of a node to be immunized)

* The effective transmission rate $\beta \rightarrow (1-g)\beta$

* $R_0$ now becomes $$R_0 = \frac{\beta}{\mu}(1-g)$$

* Recall, the epidemic threshold $$R_0 > \frac{\langle k \rangle}{\langle k^2 \rangle}$$

* so the __immunization threshold $g_c$__ $$\frac{\beta}{\mu}(1-g_c) = \frac{\langle k \rangle}{\langle k^2 \rangle}$$

* for scale-free networks

    * $\langle k^2 \rangle \rightarrow \infty$
    
    * __only a complete immunization of the network ensures an infection-free stationary state__ in the thermodynamic limit ($g_c = 1$) --><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">networkx</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nx</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="k">def</span><span class="w"> </span><span class="nf">epidemic_model_network</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">compartments</span><span class="p">,</span> <span class="n">seed_num</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">transmissions</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate an epidemic model on a networkx graph.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    G : networkx.Graph</span>
<span class="sd">        The input graph representing the contact network.</span>
<span class="sd">    compartments : dict</span>
<span class="sd">        Dictionary where keys are compartment names (e.g., &quot;S&quot;, &quot;I&quot;, &quot;R&quot;) and </span>
<span class="sd">        values are lists to store the number of nodes in each compartment at each timestep.</span>
<span class="sd">    seed_num : int</span>
<span class="sd">        Number of initial infectious nodes.</span>
<span class="sd">    T : int</span>
<span class="sd">        Number of timesteps to simulate.</span>
<span class="sd">    transmissions : dict</span>
<span class="sd">        Dictionary where keys are current statuses (e.g., &quot;S&quot;) and values are tuples </span>
<span class="sd">        `(new_status, trans_type, trans_rate_key)`. `trans_type` is either &quot;contagion&quot; </span>
<span class="sd">        or &quot;spontaneous&quot;.</span>
<span class="sd">    params : dict</span>
<span class="sd">        Dictionary mapping parameter names (e.g., &quot;beta&quot;, &quot;gamma&quot;) to their numerical values.</span>

<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    compartments : dict</span>
<span class="sd">        Updated dictionary where each key contains a list of counts over time for each compartment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize node states</span>
    <span class="n">all_nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
    <span class="n">node_status</span> <span class="o">=</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;next_status&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
                   <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">all_nodes</span><span class="p">}</span>

    <span class="c1"># Initialize compartments</span>
    <span class="k">for</span> <span class="n">cmpt</span> <span class="ow">in</span> <span class="n">compartments</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Set all nodes to susceptible initially</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">all_nodes</span><span class="p">:</span>
        <span class="n">node_status</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;S&quot;</span>
        <span class="n">compartments</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Seed infectious nodes</span>
    <span class="n">seed_nodes</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">all_nodes</span><span class="p">,</span> <span class="n">seed_num</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">seed_nodes</span><span class="p">:</span>
        <span class="n">node_status</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;I&quot;</span>
        <span class="n">compartments</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">compartments</span><span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Simulation loop over timesteps</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="c1"># Process each node&#39;s status</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">all_nodes</span><span class="p">:</span>
            <span class="n">current_status</span> <span class="o">=</span> <span class="n">node_status</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">]</span>
            <span class="n">neighbors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
            
            <span class="c1"># Check if the current status has a transition rule</span>
            <span class="k">if</span> <span class="n">current_status</span> <span class="ow">in</span> <span class="n">transmissions</span><span class="p">:</span>
                <span class="n">new_status</span><span class="p">,</span> <span class="n">trans_type</span><span class="p">,</span> <span class="n">trans_rate_key</span> <span class="o">=</span> <span class="n">transmissions</span><span class="p">[</span><span class="n">current_status</span><span class="p">]</span>
                <span class="n">trans_rate</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="n">trans_rate_key</span><span class="p">]</span>

                <span class="c1"># Contagion-based transition</span>
                <span class="k">if</span> <span class="n">trans_type</span> <span class="o">==</span> <span class="s2">&quot;contagion&quot;</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">neighbors</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">node_status</span><span class="p">[</span><span class="n">neighbor</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">new_status</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">trans_rate</span><span class="p">:</span>
                                <span class="n">node_status</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;next_status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_status</span>
                                <span class="k">break</span>

                <span class="c1"># Spontaneous transition</span>
                <span class="k">elif</span> <span class="n">trans_type</span> <span class="o">==</span> <span class="s2">&quot;spontaneous&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">trans_rate</span><span class="p">:</span>
                        <span class="n">node_status</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;next_status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_status</span>

        <span class="c1"># Update compartments for the current timestep</span>
        <span class="k">for</span> <span class="n">cmpt</span> <span class="ow">in</span> <span class="n">compartments</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">compartments</span><span class="p">[</span><span class="n">cmpt</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Update node statuses and compartments</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">all_nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">node_status</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;next_status&quot;</span><span class="p">]:</span>
                <span class="c1"># Update the node&#39;s status</span>
                <span class="n">node_status</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">node_status</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;next_status&quot;</span><span class="p">]</span>
                <span class="n">node_status</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;next_status&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            
            <span class="c1"># Count the node in its current compartment</span>
            <span class="n">compartments</span><span class="p">[</span><span class="n">node_status</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="s2">&quot;status&quot;</span><span class="p">]][</span><span class="n">t</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>


    <span class="k">return</span> <span class="n">compartments</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">barabasi_albert_graph</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="n">seed_num</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">susceptible_compartment</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span>
<span class="n">infectious_compartment</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span>

<span class="n">transmissions</span> <span class="o">=</span> <span class="p">{</span>\
                <span class="s1">&#39;S&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;contagion&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">),</span> \
                <span class="s1">&#39;I&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;spontaneous&#39;</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">)</span> \
                <span class="p">}</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
         <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
         <span class="s1">&#39;mu&#39;</span>  <span class="p">:</span> <span class="mf">0.1</span>
         <span class="p">}</span>
<span class="n">compartments</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;S&#39;</span><span class="p">:[],</span>
                <span class="s1">&#39;I&#39;</span><span class="p">:[]}</span>

<span class="n">compartments</span> <span class="o">=</span> <span class="n">epidemic_model_network</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">compartments</span><span class="p">,</span> <span class="n">seed_num</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">transmissions</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;teal&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0bae5983055dea6c45d0f991b436a2ac244ed215e585b50ffce8451fc558d779.png" src="../../_images/0bae5983055dea6c45d0f991b436a2ac244ed215e585b50ffce8451fc558d779.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ger</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">erdos_renyi_graph</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">4</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">compartments_er</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;S&#39;</span><span class="p">:[],</span>
                   <span class="s1">&#39;I&#39;</span><span class="p">:[]}</span>
<span class="n">compartments_er</span> <span class="o">=</span> <span class="n">epidemic_model_network</span><span class="p">(</span><span class="n">Ger</span><span class="p">,</span> <span class="n">compartments_er</span><span class="p">,</span> <span class="n">seed_num</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">transmissions</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

<span class="n">Gd</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">random_regular_graph</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">compartments_d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;S&#39;</span><span class="p">:[],</span>
                  <span class="s1">&#39;I&#39;</span><span class="p">:[]}</span>
<span class="n">compartments_d</span> <span class="o">=</span> <span class="n">epidemic_model_network</span><span class="p">(</span><span class="n">Gd</span><span class="p">,</span> <span class="n">compartments_d</span><span class="p">,</span> <span class="n">seed_num</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">transmissions</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;BA&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments_er</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;ER&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments_d</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;teal&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;d-reg&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/73a974576ea0f5903f92e52436685f81e7342738bcc5345239b40eaf5f28fb14.png" src="../../_images/73a974576ea0f5903f92e52436685f81e7342738bcc5345239b40eaf5f28fb14.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">barabasi_albert_graph</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">seed_num</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">susceptible_compartment</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span>
<span class="n">infectious_compartment</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span>

<span class="n">transmissions</span> <span class="o">=</span> <span class="p">{</span>\
                <span class="s1">&#39;S&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;contagion&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">),</span> \
                <span class="s1">&#39;I&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;spontaneous&#39;</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">)</span> \
                <span class="p">}</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>\
         <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>\
          <span class="s1">&#39;mu&#39;</span> <span class="p">:</span> <span class="mf">0.1</span>
         <span class="p">}</span>
<span class="n">compartments</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;S&#39;</span><span class="p">:[],</span>
                <span class="s1">&#39;I&#39;</span><span class="p">:[],</span>
                <span class="s1">&#39;R&#39;</span><span class="p">:[]}</span>

<span class="n">epidemic_model_network</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">compartments</span><span class="p">,</span> <span class="n">seed_num</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">transmissions</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;Red&quot;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;Blue&quot;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;Cyan&quot;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;R&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SIR on network&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6d455909b09cc057e9bc3954567ce7d48c97bfabc5759298c2caeb637592125e.png" src="../../_images/6d455909b09cc057e9bc3954567ce7d48c97bfabc5759298c2caeb637592125e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">Ger</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">erdos_renyi_graph</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">4</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="n">seed_num</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">susceptible_compartment</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span>
<span class="n">infectious_compartment</span> <span class="o">=</span> <span class="s1">&#39;I&#39;</span>

<span class="n">transmissions</span> <span class="o">=</span> <span class="p">{</span>\
                <span class="s1">&#39;S&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;contagion&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">),</span> \
                <span class="s1">&#39;I&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;spontaneous&#39;</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">)</span> \
                <span class="p">}</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>\
         <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>\
          <span class="s1">&#39;mu&#39;</span> <span class="p">:</span> <span class="mf">0.1</span>
         <span class="p">}</span>
<span class="n">compartments_er</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;S&#39;</span><span class="p">:[],</span>
                <span class="s1">&#39;I&#39;</span><span class="p">:[],</span>
                <span class="s1">&#39;R&#39;</span><span class="p">:[]}</span>

<span class="n">epidemic_model_network</span><span class="p">(</span><span class="n">Ger</span><span class="p">,</span> <span class="n">compartments_er</span><span class="p">,</span> <span class="n">seed_num</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">transmissions</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;BA&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">compartments_er</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;ER&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SIR on network&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f53e6bd31a1cdb66b1e4c1c75c358aed353b1d3764ad71002202be3da4c364bd.png" src="../../_images/f53e6bd31a1cdb66b1e4c1c75c358aed353b1d3764ad71002202be3da4c364bd.png" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="next-time">
<h2>Next time…<a class="headerlink" href="#next-time" title="Link to this heading">#</a></h2>
<p>Dynamics on Networks 3 — Agent-Based Models <code class="docutils literal notranslate"><span class="pre">class_18_dynamics3.ipynb</span></code></p>
</section>
<hr class="docutils" />
<section id="references-and-further-resources">
<h2>References and further resources:<a class="headerlink" href="#references-and-further-resources" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Class Webpages</p>
<ul class="simple">
<li><p>Jupyter Book: <a class="reference external" href="https://network-science-data-and-models.github.io/phys7332_fa25/README.html">https://network-science-data-and-models.github.io/phys7332_fa25/README.html</a></p></li>
<li><p>Github: <a class="github reference external" href="https://github.com/network-science-data-and-models/phys7332_fa25/">network-science-data-and-models/phys7332_fa25</a></p></li>
<li><p>Syllabus and course details: <a class="reference external" href="https://brennanklein.com/phys7332-fall25">https://brennanklein.com/phys7332-fall25</a></p></li>
</ul>
</li>
<li><p>Dietz, K. &amp; Heesterbeek, J. Bernoulli was ahead of modern epidemiology. <em>Nature</em> 408, 513–514 (2000). <a class="reference external" href="https://doi.org/10.1038/35046270">https://doi.org/10.1038/35046270</a></p></li>
<li><p>Bernoulli, D. Mém. Math. Phys. Acad. R. Sci. Paris 1–45 (1766); English translation by Bradley, L. in <em>Smallpox Inoculation: An Eighteenth Century Mathematical Controversy (Adult Education Department, Nottingham, 1971)</em>.</p></li>
<li><p>Anderson, R. M. &amp; May, R. M. Infectious Diseases of Humans — <em>Dynamics and Control</em> (Oxford University Press, Oxford, 1991).</p></li>
<li><p>Dietz, K. <em>Stat. Meth. Med. Res.</em> 2, 23–41 (1993).</p></li>
<li><p>D’Alembert, J. Opuscules Mathématiques, t. II (Paris, David, 1761).</p></li>
<li><p>Kermack William Ogilvy &amp; McKendrick A.G. (1927). A contribution to the mathematical theory of epidemics. <em>Proc. R. Soc. Lond.</em> A115700–721 <a class="reference external" href="http://doi.org/10.1098/rspa.1927.0118">http://doi.org/10.1098/rspa.1927.0118</a>.</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/class_17"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../class_16/class_16_dynamics1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Class 16: Dynamics on Networks 1 — Diffusion and Random Walks</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematical-models-of-epidemic-spreading">Mathematical Models of Epidemic Spreading</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spreading-models-what-are-they-how-do-they-work-why-do-we-use-them">Spreading Models: What are they, how do they work, why do we use them?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-component-of-compartmental-models">Basic Component of Compartmental Models</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#i-individuals-in-are-grouped-by-disease-status">I. Individuals in are grouped by  disease status:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ii-transition-between-compartments">II. Transition between compartments:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#iii-the-dynamical-process-itself">III. The dynamical process itself</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#iv-mixing-method-homogeneous-heterogeneous-etc">IV. Mixing Method: Homogeneous, Heterogeneous, etc.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#si-susceptible-infectious-dynamics">[SI] Susceptible-Infectious Dynamics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sis-susceptible-infectious-susceptible-dynamics">[SIS] Susceptible-Infectious-Susceptible Dynamics</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sis-in-homogeneous-populations">SIS in Homogeneous Populations</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-reproductive-number-r-0">Basic Reproductive Number, <span class="math notranslate nohighlight">\(R_0\)</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir-susceptible-infectious-recovered-dynamics">[SIR] Susceptible-Infectious-Recovered Dynamics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sir-model-in-homogeneous-population">SIR model in homogeneous population</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#your-turn">Your Turn!</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seir-susceptible-exposed-infectious-recovered-dynamics">[SEIR] Susceptible-Exposed-Infectious-Recovered Dynamics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">SIR model in homogeneous population</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rethinking-our-code">Rethinking our code…</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#epidemic-dynamics-on-networks">Epidemic Dynamics on Networks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-time">Next time…</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references-and-further-resources">References and further resources:</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Brennan Klein
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>